A = [ 2.591, 0.512, 0.128, 0.195; 
      0.203, 3.469, 0.572, 0.168; 
      0.256, 0.273, 2.994, 0.501; 
      0.381, 0.219, 0.176, 5.903 ]
B = [ 0.159;
      0.280;
      0.134;
      0.864 ]
C = cat(2, A, B);
C1 = C;
C2 = C;

for i = 2 : 4
    for j = 1 : 4
        C(i, j) = C1(i, j) - C1(1, j) *  C1(i, 1) / C1(1, 1);
        C(i, 5) = C1(i, 5) - C1(1, 5) * C1(i, 1) / C1(1, 1);
    end
end
C1 = C;

for i = 3 : 4
    for j = 2 : 4
        C(i, j) = C1(i, j) - C1(2, j) *  C1(i, 2) / C1(2, 2);
        C(i, 5) = C1(i, 5) - C1(2, 5) * C1(i, 2) / C1(2, 2);
    end
end
C1 = C;
for i = 4 : 4
    for j = 3 : 4
        C(i, j) = C1(i, j) - C1(3, j) *  C1(i, 3) / C1(3, 3);
        C(i, 5) = C1(i, 5) - C1(3, 5) * C1(i, 3) / C1(3, 3);
    end
end
C1 = C;
x4 = C(4, 5) / C(4, 4);
x3 = (C(3, 5) - x4 * C(3, 4)) / C(3, 3);
x2 = (C(2, 5) - x4 * C(2, 4) - x3 * C(2, 3)) / C(2, 2);
x1 = (C(1, 5) - x4 * C(1, 4) - x3 * C(1, 3) - x2 * C(1, 2)) / C(1, 1);
fprintf("x1 = %f; x2 = %f; x3 = %f; x4 = %f", x1, x2, x3, x4);
rref(C2)
